# Migration `20200614220949-cambiando-la-clave-foranea-entre-personal-y-credencial`

This migration has been generated by Andres Baldarrago at 6/14/2020, 10:09:49 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."Personal_credencialId"

ALTER TABLE "public"."Credencial" ADD COLUMN "personalId" integer  NOT NULL ;

ALTER TABLE "public"."Personal" DROP CONSTRAINT IF EXiSTS "Personal_credencialId_fkey",
DROP COLUMN "credencialId";

CREATE UNIQUE INDEX "Credencial_personalId" ON "public"."Credencial"("personalId")

ALTER TABLE "public"."Credencial" ADD FOREIGN KEY ("personalId")REFERENCES "public"."Personal"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200614213347-agregando-estado-en-pedido..20200614220949-cambiando-la-clave-foranea-entre-personal-y-credencial
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 model Cargo {
   id       Int        @default(autoincrement()) @id
@@ -15,21 +15,21 @@
   nombres          String
   apellidos        String
   cargo            Cargo       @relation(fields: [cargoId], references: [id])
   cargoId          Int
-  credencial       Credencial? @relation(fields: [credencialId], references: [id])
-  credencialId     Int?
   sueldo           Float
   estado           Boolean     @default(true)
   pedidosAtendidos Pedido[]
+  credencial       Credencial?
 }
 model Credencial {
-  id       Int      @default(autoincrement()) @id
-  usuario  String   @unique
-  clave    String
-  estado   Boolean  @default(true)
-  personal Personal
+  id         Int      @default(autoincrement()) @id
+  usuario    String   @unique
+  clave      String
+  estado     Boolean  @default(true)
+  personal   Personal @relation(fields: [personalId], references: [id])
+  personalId Int
 }
 model Insumo {
   id                Int              @default(autoincrement()) @id
```


